# –ü–ª–∞–Ω: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Fortune City

## –û–±–∑–æ—Ä
–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π Fortune City —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** user/pass –∏–∑ .env (–±–µ–∑ 2FA, –±–µ–∑ email)
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/admin/*` —Ä–æ—É—Ç—ã –≤ apps/web
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—Å–µ–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º—ã

---

## –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –°–ø–∏—Å–æ–∫ —Å –ø–æ–∏—Å–∫–æ–º/—Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–±–∞–ª–∞–Ω—Å, –º–∞—à–∏–Ω—ã, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
- **–ë–∞–Ω/–∞–Ω–±–∞–Ω** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–±–∞–ª–∞–Ω—Å, –Ω–∞–ª–æ–≥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞)
- **–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏** (–¥–µ—Ä–µ–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤, 3 —É—Ä–æ–≤–Ω—è)

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞–º–∏ (–ù–û–í–û–ï)
- **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤** (tier 11, 12, ...)
- **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö** (—Ü–µ–Ω–∞, –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, —Å—Ä–æ–∫)
- **–°–∫—Ä—ã—Ç–∏–µ/–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** —Ç–∞—Ä–∏—Ñ–æ–≤ (isVisible)
- **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏** (isPubliclyAvailable)
- –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (sortOrder)

### 3. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫–æ–Ω–æ–º–∏–∫–∏
- **minDepositAmount** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –ø–æ –≤–∞–ª—é—Ç–∞–º
- **minWithdrawalAmount** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
- **walletConnectFee** - –∫–æ–º–∏—Å—Å–∏—è –∑–∞ –≤—ã–≤–æ–¥ —á–µ—Ä–µ–∑ Wallet Connect (SOL)
- **globalTaxRates** - –Ω–∞–ª–æ–≥–æ–≤—ã–µ —Å—Ç–∞–≤–∫–∏ –ø–æ —Ç–∏—Ä–∞–º
- **referralRates** - —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ % –ø–æ —É—Ä–æ–≤–Ω—è–º
- **reinvestReduction** - —à—Ç—Ä–∞—Ñ—ã –∑–∞ —Ä–µ–∏–Ω–≤–µ—Å—Ç
- **pawnshopCommission** - –∫–æ–º–∏—Å—Å–∏—è –ª–æ–º–±–∞—Ä–¥–∞
- **auctionCommissions** - –∫–æ–º–∏—Å—Å–∏–∏ –∞—É–∫—Ü–∏–æ–Ω–∞ –ø–æ wear%
- **gambleMultipliers** - –º–Ω–æ–∂–∏—Ç–µ–ª–∏ Fortune's Gamble
- **coinBoxLevels** - —É—Ä–æ–≤–Ω–∏ Coin Box
- **autoCollectCostPercent** - —Å—Ç–æ–∏–º–æ—Å—Ç—å Auto Collect

### 4. –°–∏—Å—Ç–µ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **Solana –∞–¥—Ä–µ—Å–∞** (hot wallet, payout wallet)
- **API –∫–ª—é—á–∏** (Helius, Telegram Bot Token)
- **RPC URL**
- **Fortune Mint Address**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ .env

### 5. –§–∏–Ω–∞–Ω—Å—ã
- –°–ø–∏—Å–æ–∫ –¥–µ–ø–æ–∑–∏—Ç–æ–≤ (—Å—Ç–∞—Ç—É—Å, —Ä—É—á–Ω–æ–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ)
- –°–ø–∏—Å–æ–∫ –≤—ã–≤–æ–¥–æ–≤ (approve/reject)
- –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### 6. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- Dashboard —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- –ì—Ä–∞—Ñ–∏–∫–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –æ–±—ä—ë–º—ã, –º–∞—à–∏–Ω—ã)
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Backend (NestJS)

#### –ù–æ–≤—ã–µ/—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ Prisma

```prisma
// ============== TIER CONFIG (–ù–û–í–û–ï) ==============
// –ó–∞–º–µ–Ω—è–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π MACHINE_TIERS

model TierConfig {
  id              String   @id @default(cuid())
  tier            Int      @unique
  name            String                          // "RUSTY LEVER"
  emoji           String                          // "üü§"
  price           Decimal  @db.Decimal(20, 2)     // 10
  lifespanDays    Int      @map("lifespan_days")  // 7
  yieldPercent    Int      @map("yield_percent")  // 135
  imageUrl        String?  @map("image_url")

  // –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
  isVisible       Boolean  @default(true)         // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ
  isPubliclyAvailable Boolean @default(false)     // –î–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏
  sortOrder       Int      @default(0)            // –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("tier_configs")
}

// ============== SYSTEM SETTINGS (–†–ê–°–®–ò–†–ï–ù–ù–û–ï) ==============

model SystemSettings {
  id              String @id @default("default")

  // –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ç–∏—Ä–æ–≤
  maxGlobalTier   Int    @default(1)              // –ú–∞–∫—Å —Ç–∏—Ä –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏

  // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å—É–º–º—ã (JSON –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≤–∞–ª—é—Ç)
  minDepositAmounts   Json @default("{\"SOL\":0.01,\"USDT_SOL\":1,\"FORTUNE\":10}")
  minWithdrawalAmount Decimal @default(5) @db.Decimal(20, 2)

  // –ö–æ–º–∏—Å—Å–∏–∏
  walletConnectFeeSol Decimal @default(0.003) @db.Decimal(10, 6)  // SOL fee
  pawnshopCommission  Decimal @default(0.10) @db.Decimal(5, 4)    // 10%

  // –ù–∞–ª–æ–≥–∏ (JSON: {tierNumber: rate})
  taxRatesByTier      Json @default("{\"1\":0.5,\"2\":0.5,\"3\":0.4,\"4\":0.4,\"5\":0.3,\"6\":0.3,\"7\":0.2,\"8\":0.2,\"9\":0.2,\"10\":0.1}")

  // –†–µ—Ñ–µ—Ä–∞–ª—ã (JSON: {level: rate})
  referralRates       Json @default("{\"1\":0.05,\"2\":0.03,\"3\":0.01}")

  // –†–µ–∏–Ω–≤–µ—Å—Ç —à—Ç—Ä–∞—Ñ—ã (JSON: {round: rate})
  reinvestReduction   Json @default("{\"1\":0,\"2\":0.05,\"3\":0.10,\"4\":0.15,\"5\":0.23,\"6\":0.33,\"7\":0.45,\"8\":0.58,\"9\":0.70,\"10\":0.80,\"11\":0.85}")

  // –ê—É–∫—Ü–∏–æ–Ω –∫–æ–º–∏—Å—Å–∏–∏ (JSON: {wearPercent: commission})
  auctionCommissions  Json @default("{\"20\":0.10,\"40\":0.20,\"60\":0.35,\"80\":0.55,\"100\":0.75}")

  // Early sell –∫–æ–º–∏—Å—Å–∏–∏ (JSON: {progressPercent: commission})
  earlySellCommissions Json @default("{\"20\":0.20,\"40\":0.35,\"60\":0.55,\"80\":0.75,\"100\":0.90}")

  // Fortune's Gamble
  gambleWinMultiplier  Decimal @default(2.0) @db.Decimal(5, 2)
  gambleLoseMultiplier Decimal @default(0.5) @db.Decimal(5, 2)
  gambleLevels         Json @default("[{\"level\":0,\"winChance\":0.1333,\"costPercent\":0},{\"level\":1,\"winChance\":0.1533,\"costPercent\":3},{\"level\":2,\"winChance\":0.1733,\"costPercent\":6},{\"level\":3,\"winChance\":0.1867,\"costPercent\":10}]")

  // Coin Box
  coinBoxLevels        Json @default("[{\"level\":1,\"capacityHours\":2,\"costPercent\":0},{\"level\":2,\"capacityHours\":6,\"costPercent\":5},{\"level\":3,\"capacityHours\":12,\"costPercent\":10},{\"level\":4,\"capacityHours\":24,\"costPercent\":20},{\"level\":5,\"capacityHours\":48,\"costPercent\":35}]")

  // Auto Collect
  autoCollectCostPercent Int @default(15)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("system_settings")
}

// ============== USER (–î–û–ü–û–õ–ù–ï–ù–ò–ï) ==============
// –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –¥–ª—è –±–∞–Ω–∞

model User {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...

  isBanned        Boolean  @default(false)
  bannedAt        DateTime?
  bannedReason    String?

  // ...
}

// ============== AUDIT LOG ==============

model AuditLog {
  id          String   @id @default(cuid())
  adminAction String   @map("admin_action")    // "user_banned", "settings_updated", etc
  resource    String                           // "user", "tier", "settings"
  resourceId  String?  @map("resource_id")
  oldValue    Json?    @map("old_value")
  newValue    Json?    @map("new_value")
  ipAddress   String?  @map("ip_address")
  createdAt   DateTime @default(now())

  @@index([adminAction])
  @@index([createdAt])
  @@map("audit_logs")
}
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

```
apps/api/src/modules/admin/
‚îú‚îÄ‚îÄ admin.module.ts
‚îú‚îÄ‚îÄ admin-auth/
‚îÇ   ‚îú‚îÄ‚îÄ admin-auth.controller.ts     # POST /admin/auth/login
‚îÇ   ‚îú‚îÄ‚îÄ admin-auth.service.ts        # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ ADMIN_USER/ADMIN_PASS –∏–∑ .env
‚îÇ   ‚îî‚îÄ‚îÄ guards/admin.guard.ts        # JWT guard
‚îú‚îÄ‚îÄ admin-users/
‚îÇ   ‚îú‚îÄ‚îÄ admin-users.controller.ts    # GET/POST /admin/users/*
‚îÇ   ‚îú‚îÄ‚îÄ admin-users.service.ts
‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ       ‚îú‚îÄ‚îÄ ban-user.dto.ts
‚îÇ       ‚îî‚îÄ‚îÄ update-user.dto.ts
‚îú‚îÄ‚îÄ admin-tiers/
‚îÇ   ‚îú‚îÄ‚îÄ admin-tiers.controller.ts    # CRUD /admin/tiers/*
‚îÇ   ‚îî‚îÄ‚îÄ admin-tiers.service.ts
‚îú‚îÄ‚îÄ admin-settings/
‚îÇ   ‚îú‚îÄ‚îÄ admin-settings.controller.ts # GET/PUT /admin/settings/*
‚îÇ   ‚îî‚îÄ‚îÄ admin-settings.service.ts
‚îú‚îÄ‚îÄ admin-deposits/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ admin-withdrawals/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ admin-analytics/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ admin-audit/
    ‚îî‚îÄ‚îÄ ...
```

#### API Endpoints

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø—Ä–æ—Å—Ç–∞—è):**
```
POST /admin/auth/login
Body: { username: string, password: string }
Response: { accessToken: string }
// –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–æ—Ç–∏–≤ ADMIN_USER –∏ ADMIN_PASS –∏–∑ .env
```

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
```
GET  /admin/users                    # –°–ø–∏—Å–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
GET  /admin/users/:id                # –î–µ—Ç–∞–ª–∏ + –º–∞—à–∏–Ω—ã + —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
GET  /admin/users/:id/referrals      # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–µ—Ç—å (–¥–µ—Ä–µ–≤–æ 3 —É—Ä–æ–≤–Ω—è)
POST /admin/users/:id/ban            # –ó–∞–±–∞–Ω–∏—Ç—å
POST /admin/users/:id/unban          # –†–∞–∑–±–∞–Ω–∏—Ç—å
PUT  /admin/users/:id                # –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–±–∞–ª–∞–Ω—Å, etc)
```

**–¢–∞—Ä–∏—Ñ—ã:**
```
GET    /admin/tiers                  # –í—Å–µ —Ç–∏—Ä—ã (–≤–∫–ª—é—á–∞—è —Å–∫—Ä—ã—Ç—ã–µ)
GET    /admin/tiers/:tier            # –û–¥–∏–Ω —Ç–∏—Ä
POST   /admin/tiers                  # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏—Ä
PUT    /admin/tiers/:tier            # –û–±–Ω–æ–≤–∏—Ç—å —Ç–∏—Ä
DELETE /admin/tiers/:tier            # –£–¥–∞–ª–∏—Ç—å (soft delete)
PUT    /admin/tiers/:tier/visibility # –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å
PUT    /admin/tiers/:tier/availability # –°–¥–µ–ª–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–º/–ø—Ä–∏–≤–∞—Ç–Ω—ã–º
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
```
GET  /admin/settings                 # –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
PUT  /admin/settings                 # –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
GET  /admin/settings/env             # –ü–æ–∫–∞–∑–∞—Ç—å .env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (readonly)
```

**–í—ã–≤–æ–¥—ã:**
```
GET  /admin/withdrawals              # –°–ø–∏—Å–æ–∫
POST /admin/withdrawals/:id/approve  # –û–¥–æ–±—Ä–∏—Ç—å
POST /admin/withdrawals/:id/reject   # –û—Ç–∫–ª–æ–Ω–∏—Ç—å
```

---

### Frontend (Next.js)

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ—É—Ç–æ–≤

```
apps/web/src/app/admin/
‚îú‚îÄ‚îÄ layout.tsx                       # –û—Ç–¥–µ–ª—å–Ω—ã–π layout
‚îú‚îÄ‚îÄ page.tsx                         # ‚Üí /admin/dashboard
‚îú‚îÄ‚îÄ login/page.tsx                   # –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ dashboard/page.tsx               # –û–±–∑–æ—Ä–Ω—ã–π –¥–∞—à–±–æ—Ä–¥
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                     # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ [id]/
‚îÇ       ‚îú‚îÄ‚îÄ page.tsx                 # –î–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ       ‚îî‚îÄ‚îÄ referrals/page.tsx       # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
‚îú‚îÄ‚îÄ tiers/
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                     # –°–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ new/page.tsx                 # –°–æ–∑–¥–∞—Ç—å —Ç–∞—Ä–∏—Ñ
‚îÇ   ‚îî‚îÄ‚îÄ [tier]/page.tsx              # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞—Ä–∏—Ñ
‚îú‚îÄ‚îÄ settings/
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                     # –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ economy/page.tsx             # –≠–∫–æ–Ω–æ–º–∏–∫–∞ (–Ω–∞–ª–æ–≥–∏, –∫–æ–º–∏—Å—Å–∏–∏)
‚îÇ   ‚îú‚îÄ‚îÄ deposits/page.tsx            # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ–ø–æ–∑–∏—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ withdrawals/page.tsx         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã–≤–æ–¥–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ system/page.tsx              # –°–∏—Å—Ç–µ–º–Ω—ã–µ (.env readonly)
‚îú‚îÄ‚îÄ withdrawals/page.tsx             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞–º–∏
‚îú‚îÄ‚îÄ deposits/page.tsx                # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–∞–º–∏
‚îî‚îÄ‚îÄ audit/page.tsx                   # –ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π
```

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
apps/web/src/components/admin/
‚îú‚îÄ‚îÄ layout/
‚îÇ   ‚îú‚îÄ‚îÄ AdminLayout.tsx
‚îÇ   ‚îú‚îÄ‚îÄ AdminSidebar.tsx
‚îÇ   ‚îî‚îÄ‚îÄ AdminHeader.tsx
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îú‚îÄ‚îÄ UsersTable.tsx
‚îÇ   ‚îú‚îÄ‚îÄ UserDetails.tsx
‚îÇ   ‚îú‚îÄ‚îÄ BanUserModal.tsx
‚îÇ   ‚îú‚îÄ‚îÄ EditBalanceModal.tsx
‚îÇ   ‚îî‚îÄ‚îÄ ReferralTree.tsx             # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
‚îú‚îÄ‚îÄ tiers/
‚îÇ   ‚îú‚îÄ‚îÄ TiersTable.tsx
‚îÇ   ‚îú‚îÄ‚îÄ TierForm.tsx                 # –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ TierVisibilityToggle.tsx
‚îú‚îÄ‚îÄ settings/
‚îÇ   ‚îú‚îÄ‚îÄ EconomySettingsForm.tsx
‚îÇ   ‚îú‚îÄ‚îÄ DepositSettingsForm.tsx
‚îÇ   ‚îú‚îÄ‚îÄ WithdrawalSettingsForm.tsx
‚îÇ   ‚îî‚îÄ‚îÄ SystemEnvDisplay.tsx         # Readonly –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ .env
‚îú‚îÄ‚îÄ withdrawals/
‚îÇ   ‚îú‚îÄ‚îÄ WithdrawalsTable.tsx
‚îÇ   ‚îî‚îÄ‚îÄ ApproveRejectModal.tsx
‚îî‚îÄ‚îÄ common/
    ‚îú‚îÄ‚îÄ DataTable.tsx
    ‚îú‚îÄ‚îÄ StatCard.tsx
    ‚îî‚îÄ‚îÄ JsonEditor.tsx               # –î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JSON –ø–æ–ª–µ–π
```

#### Stores (Zustand)

```
apps/web/src/stores/admin/
‚îú‚îÄ‚îÄ admin-auth.store.ts
‚îú‚îÄ‚îÄ admin-users.store.ts
‚îú‚îÄ‚îÄ admin-tiers.store.ts
‚îú‚îÄ‚îÄ admin-settings.store.ts
‚îú‚îÄ‚îÄ admin-withdrawals.store.ts
‚îî‚îÄ‚îÄ admin-deposits.store.ts
```

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–æ–≤—ã–µ)

```env
# Admin Panel
ADMIN_USER=admin
ADMIN_PASS=supersecretpassword123
ADMIN_JWT_SECRET=admin_jwt_secret_key
```

---

## –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –Ω—É–∂–Ω–æ:
1. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å MACHINE_TIERS –∏–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü—É TierConfig
2. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ SystemSettings
3. –°–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã —á–∏—Ç–∞—Ç—å –∏–∑ –ë–î –≤–º–µ—Å—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç

**Seed —Å–∫—Ä–∏–ø—Ç:**
```typescript
// prisma/seed-admin.ts
async function seedTiers() {
  const existingTiers = await prisma.tierConfig.count();
  if (existingTiers > 0) return;

  await prisma.tierConfig.createMany({
    data: MACHINE_TIERS.map(t => ({
      tier: t.tier,
      name: t.name,
      emoji: t.emoji,
      price: t.price,
      lifespanDays: t.lifespanDays,
      yieldPercent: t.yieldPercent,
      imageUrl: t.imageUrl,
      isVisible: true,
      isPubliclyAvailable: t.tier === 1, // –¢–æ–ª—å–∫–æ 1 —Ç–∏—Ä –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω
      sortOrder: t.tier,
    })),
  });
}
```

---

## –ü–ª–∞–Ω –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏

### Phase 1: –û—Å–Ω–æ–≤–∞
1. –î–æ–±–∞–≤–∏—Ç—å Prisma –º–æ–¥–µ–ª–∏ (TierConfig, —Ä–∞—Å—à–∏—Ä–∏—Ç—å SystemSettings, AuditLog)
2. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∏ seed —Å–∫—Ä–∏–ø—Ç
3. –ü—Ä–æ—Å—Ç–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞ (user/pass –∏–∑ .env)
4. AdminLayout + login page
5. –ë–∞–∑–æ–≤—ã–π dashboard

### Phase 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞–º–∏
1. CRUD –¥–ª—è TierConfig
2. UI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞—Ä–∏—Ñ–æ–≤
3. Visibility –∏ availability toggles
4. –û–±–Ω–æ–≤–∏—Ç—å MachinesService —á–∏—Ç–∞—Ç—å –∏–∑ –ë–î

### Phase 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫–æ–Ω–æ–º–∏–∫–∏
1. UI –¥–ª—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ SystemSettings
2. JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –ø–æ–ª–µ–π
3. –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã —á–∏—Ç–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ë–î
4. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ Redis

### Phase 4: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
1. –°–ø–∏—Å–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –ø–æ–∏—Å–∫–æ–º
2. –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ë–∞–Ω/–∞–Ω–±–∞–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
4. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ (–¥–µ—Ä–µ–≤–æ)

### Phase 5: –§–∏–Ω–∞–Ω—Å—ã –∏ –∞—É–¥–∏—Ç
1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞–º–∏ (approve/reject)
2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–∞–º–∏
3. Audit log –¥–ª—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
4. Dashboard —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏

**Backend:**
- `apps/api/prisma/schema.prisma` - –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏
- `apps/api/src/app.module.ts` - –ø–æ–¥–∫–ª—é—á–∏—Ç—å AdminModule
- `apps/api/src/modules/machines/machines.service.ts` - —á–∏—Ç–∞—Ç—å —Ç–∏—Ä—ã –∏–∑ –ë–î
- `apps/api/src/modules/economy/economy.service.ts` - —á–∏—Ç–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ë–î
- `packages/shared/src/constants/tiers.ts` - –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ deprecated

**Frontend:**
- `apps/web/src/app/admin/layout.tsx` - –Ω–æ–≤—ã–π layout
- `apps/web/src/middleware.ts` - –∑–∞—â–∏—Ç–∞ /admin/* —Ä–æ—É—Ç–æ–≤

---

## –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

1. **Login:** –ê–¥–º–∏–Ω –≤—Ö–æ–¥–∏—Ç —Å user/pass –∏–∑ .env
2. **Tiers:** –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å tier 11, —Å–∫—Ä—ã—Ç—å tier 10, —Å–¥–µ–ª–∞—Ç—å tier 3 –ø—É–±–ª–∏—á–Ω—ã–º
3. **Settings:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ minDeposit –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤ /deposits/rates
4. **Users:** –ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –µ–≥–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
5. **Referrals:** –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 3 —É—Ä–æ–≤–Ω—è —Å–≤—è–∑–µ–π
6. **Audit:** –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ audit_logs

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
cd apps/api && pnpm prisma migrate dev
cd apps/api && pnpm prisma db seed
cd apps/api && pnpm test && pnpm build
cd apps/web && pnpm lint && pnpm build
```
